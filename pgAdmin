--Creating tables for Zipcodes
CREATE TABLE Sonoma_Counts_Census (
	ZipCode INT NOT NULL, 
	Population INT NOT NULL,
	Number_of_Households INT NOT NULL,
	Median_Income INT NOT NULL,
	Average_Income INT NOT NULL,
	PRIMARY KEY (ZipCode)
);

DROP TABLE Animal_Shelter_Intake_and_Outake
CREATE TABLE sonoma_shelter_clean (
	ZipCode INT NOT NULL,
	Animal_ID INT NOT NULL,
	Animal_Type VARCHAR NOT NULL,
	Breed VARCHAR NOT NULL,
	Animal_Size VARCHAR NOT NULL,
	Outcome_Type VARCHAR NOT NULL,
    Outcome_Jurisdiction VARCHAR NOT NULL,
    Intake_Jurisdiction VARCHAR NOT NULL
,FOREIGN KEY (ZipCode) REFERENCES Sonoma_Counts_Census (ZipCode),
    PRIMARY KEY (ZipCode)
);
DROP TABLE Food_Facilties
CREATE Table Food_Facilities (
	ZipCode INT NOT NULL,
	Facility_Name Varchar NOT NULL, 
	Address Varchar NOT NULL, 
	City Varchar NOT NULL,
	State_location Varchar NOT NULL
,FOREIGN KEY (ZipCode) REFERENCES sonoma_shelter_clean (ZipCode),
    PRIMARY KEY (ZipCode)
);

CREATE Table sonoma_county_weather_clean (
	month_date INT NOT NULL,
	high_temp INT NOT NULL, 
	low_temp INT NOT NULL, 
	rain INT NOT NULL,
    PRIMARY KEY (month_date)
);

--Joining 3 tables Sonoma_Counts_Census, Animal_Shelter_Intake_and _Outake, and Food Facilties
Select 
	Sonoma_Counts_Census.ZipCode,
	Sonoma_Counts_Census.Population,
	Sonoma_Counts_Census.Number_of_Households,
	Sonoma_Counts_Census.Median_Income,
	Sonoma_Counts_Census.Average_Income,
	sonoma_shelter_clean.ZipCode,
	sonoma_shelter_clean.Animal_ID,
	sonoma_shelter_clean.Animal_Type,
	sonoma_shelter_clean.Breed,
	sonoma_shelter_clean.Animal_Size,
	sonoma_shelter_clean.Outcome_Type,
	sonoma_shelter_clean.Outcome_Jurisdiction,
	sonoma_shelter_clean.Intake_Jurisdiction,
	Food_Facilities.ZipCode,
	Food_Facilities.Facility_name,
	Food_Facilities.Address,
	Food_Facilities.City,
	Food_Facilities.State_Location
FROM Sonoma_Counts_Census
JOIN sonoma_shelter_clean
	ON Sonoma_Counts_Census.ZipCode=sonoma_shelter_clean.Zipcode
JOIN Food_Facilities
	ON Food_Facilities.ZipCode=sonoma_shelter_clean.Zipcode
	
